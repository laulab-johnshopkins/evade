
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>volume_finder package &#8212; volume_finder 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="volume-finder-package">
<h1>volume_finder package<a class="headerlink" href="#volume-finder-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-volume_finder.dihedrals">
<span id="volume-finder-dihedrals-module"></span><h2>volume_finder.dihedrals module<a class="headerlink" href="#module-volume_finder.dihedrals" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.dihedrals.add_correlated_dihedrals">
<span class="sig-prename descclassname"><span class="pre">volume_finder.dihedrals.</span></span><span class="sig-name descname"><span class="pre">add_correlated_dihedrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nglview_widget</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_cutoff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.dihedrals.add_correlated_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Show correlated dihedrals in an NGLView display.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nglview_widget</strong> (<em>NGLView Widget</em>) – An NGLView widget object.</p></li>
<li><p><strong>u</strong> (<em>MDAnalysis Universe</em>) – An MDAnalysis Universe containing the system shown in <cite>nglview_widget</cite>.</p></li>
<li><p><strong>corr_mat</strong> (<em>Pandas DataFrame</em>) – The correlation matrix produced by dataframe.corr().</p></li>
<li><p><strong>corr_cutoff</strong> (<em>float</em>) – The minimum correlation strength needed for the correlation to be displayed.  The function takes the
absolute value of the correlations to consider both positive and negative correlations as significant;
thus <cite>corr_cutoff</cite> should be positive.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function modifies the input object <cite>nglview_widget</cite>, as described below:</p>
<p>A sphere is drawn at each key atom’s position.  A line is drawn between each shown correlation.  The line
thickness is determined by correlation strength.  Hovering the mouse over a line causes it to display info
about the correlation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.dihedrals.correlate_dists_to_observable">
<span class="sig-prename descclassname"><span class="pre">volume_finder.dihedrals.</span></span><span class="sig-name descname"><span class="pre">correlate_dists_to_observable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_index_to_dist_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.dihedrals.correlate_dists_to_observable" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the correlations between each residue’s distance from first frame position and another observable.</p>
<p>This function should be run after <cite>get_atom_movements</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dict_index_to_dist_list</strong> (<em>dictionary mapping integers to 1D arrays</em>) – This argument should be the output of <cite>get_atom_movements</cite>.  Each key is an MDAnalysis atom index;
each value is a list of the atom’s distance from first frame position at every studied frame.  Note that
<cite>get_atom_movements</cite> can iterate over frames with step size &gt;= 1.</p></li>
<li><p><strong>observable</strong> (<em>list-like</em>) – This contains an observable’s value at each trajectory frame that <cite>dict_index_to_dist_list</cite> has
distances for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sorted_indices</strong> (<em>list of integers</em>) – A list of keys of <cite>dict_index_to_dist_list</cite>, sorted lowest to highest.</p></li>
<li><p><strong>corrs</strong> (<em>list of floats</em>) – The Pearson correlation coefficient between each atom’s distance from first frame and <cite>observable</cite>.</p></li>
<li><p><strong>pvals</strong> (<em>list of floats</em>) – The p-value for each atom’s Pearson coefficient.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.dihedrals.explain_atom_corr_with_observable">
<span class="sig-prename descclassname"><span class="pre">volume_finder.dihedrals.</span></span><span class="sig-name descname"><span class="pre">explain_atom_corr_with_observable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_index_to_dist_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedral_pearson_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.dihedrals.explain_atom_corr_with_observable" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if an atom’s correlation with an observable can be explained by a dihedral angle.</p>
<p>This function should be run after <cite>get_atoms_that_corr</cite>.  It operates on a single atom, checking
if a dihedral on that atom’s residue correlates with the observable.  The function considers both
positive and negative correlations to be meaningful.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom</strong> (<em>MDAnalysis Atom object</em>) – An atom whose distance from first-frame position correlates with <cite>obervable</cite>.</p></li>
<li><p><strong>observable</strong> (<em>list-like</em>) – This contains an observable’s value at each analyzed frame of an MD trajectory.</p></li>
<li><p><strong>observable_label</strong> (<em>string</em>) – A short description of the observable, to be used when labeling graphs created by the function.</p></li>
<li><p><strong>dict_index_to_dist_list</strong> (<em>dictionary mapping integers to 1D arrays</em>) – This argument should be the output of <cite>get_atom_movements</cite>.  Each key is an MDAnalysis atom index;
each value is a list of the atom’s distance from first frame position at every studied frame.</p></li>
<li><p><strong>dihedral_pearson_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum correlation strength between a dihedral and <cite>observable</cite> that is considered meaningful.
The default value is 0.3.  The function uses the absolute value of correlations to include negative
correlations; thus <cite>dihedral_pearson_cutoff</cite> should always be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>dihedral_dict</strong> – A dictionary listing various results about the dihedrals.  It contains:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;distance_from_first_frame&quot;</span></code></dt><dd><p>1D array of floats containing the atom’s distance from first-frame position at each studied frame.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;distance_from_first_frame_pearson&quot;</span></code></dt><dd><p>A scipy PearsonRResult object correlating the phi dihedral with <cite>observable</cite>.
<cite>dihedral_dict[“distance_from_first_frame_pearson”][0]</cite> is the Pearson coefficient, while
<cite>dihedral_dict[“distance_from_first_frame_pearson”][1]</cite> is the p-value.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;phi&quot;</span></code></dt><dd><p>Phi dihedral for <cite>atom</cite>’s residue at each studied frame.  Is <cite>None</cite> if not defined for this residue
(e.g. because of its position at end of chain).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;phi_pearson&quot;</span></code></dt><dd><p>A scipy PearsonRResult object correlating the phi dihedral with <cite>observable</cite>.
<cite>dihedral_dict[“phi_pearson”][0]</cite> is the Pearson coefficient, while <cite>dihedral_dict[“phi_pearson”][1]</cite>
is the p-value.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;psi&quot;</span></code></dt><dd><p>Phi dihedral for <cite>atom</cite>’s residue at each studied frame.  Is <cite>None</cite> if not defined for this residue
(e.g. because of its position at end of chain).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;psi_pearson&quot;</span></code></dt><dd><p>A scipy PearsonRResult object correlating the psi dihedral with <cite>observable</cite>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;chi1&quot;</span></code></dt><dd><p>Chi1 dihedral for <cite>atom</cite>’s residue at each studied frame.  Is <cite>None</cite> if not defined for this residue
(e.g. because sidechain is too short).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;chi1_pearson&quot;</span></code></dt><dd><p>A scipy PearsonRResult object correlating the chi1 dihedral with <cite>observable</cite>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;chi2&quot;</span></code></dt><dd><p>Chi2 dihedral for <cite>atom</cite>’s residue at each studied frame.  Is <cite>None</cite> if not defined for this residue
(e.g. because sidechain is too short).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;chi2_pearson&quot;</span></code></dt><dd><p>A scipy PearsonRResult object correlating the chi2 dihedral with <cite>observable</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.dihedrals.get_atom_movements">
<span class="sig-prename descclassname"><span class="pre">volume_finder.dihedrals.</span></span><span class="sig-name descname"><span class="pre">get_atom_movements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.dihedrals.get_atom_movements" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantify atoms’ motions from their positions at the first frame of the MD trajectory.</p>
<p>Iterate over the trajectory.  At each studied frame, find all heavy atoms’ distances
from their positions at the first frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDAnalysis universe</em>) – The universe object that the data are taken from.  WARNING: this should be aligned based on
the residues in <cite>selection</cite>.</p></li>
<li><p><strong>iter_step</strong> (<em>integer</em><em>, </em><em>optional</em>) – The step size for iterating over the trajectory.  E.g. with a step size of 10, the analysis is performed
on every 10th frame.  Th default value is 1, which iterates over every frame.</p></li>
<li><p><strong>selection</strong> (<em>string</em><em>, </em><em>optional</em>) – An MDAnalysis selection string describing the residues to be studied.  The default value of
“protein” selects all protein residues.  Any hydrogens in <cite>selection</cite> will be ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Each key is the MDAnalysis atom index of a heavy atom.  (Every heavy atom described by <cite>selection</cite> will
have a key.)  Each value is an array listing the atom’s distance from its first-frame position at each
studied frame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary mapping integers to 1D arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.dihedrals.get_atoms_that_corr">
<span class="sig-prename descclassname"><span class="pre">volume_finder.dihedrals.</span></span><span class="sig-name descname"><span class="pre">get_atoms_that_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.dihedrals.get_atoms_that_corr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get atoms whose correlation with an observable has magnitude greater than a cutoff.</p>
<p>This function should be run after <cite>correlate_dists_to_observable</cite>.  If a residue
has multiple atoms with correlations beyond the threshold, this function only chooses
the atom with the strongest correlation.  When comparing correlation values, the function uses
the absolute value of the Pearson coefficient; therefore the function considers values close to
either 1 or -1 as being strong.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corr_cutoff</strong> (<em>float</em>) – The cutoff for considering correlations to be meaningful.</p></li>
<li><p><strong>sorted_indices</strong> (<em>list-like</em>) – A list of MDAnalysis atom indices for all atoms to be studied.  This is returned by
<cite>correlate_dists_to_observable</cite>.</p></li>
<li><p><strong>corrs</strong> (<em>list of floats</em>) – The Pearson correlation coefficient between each atom’s distance from first frame and an
observable.  This is returned by <cite>correlate_dists_to_observable</cite>.</p></li>
<li><p><strong>u</strong> (<em>MDAnalysis universe</em>) – The universe object that the data are taken from.  It should be aligned based on
the residues in <cite>selection</cite>; it is likely the same object used as an argument to <cite>get_atom_movements</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>atom_indices_that_corr</strong> – A list of MDAnalysis atom indices of atoms whose motion correlates with an observable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of integers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.dihedrals.get_best_dihedrals">
<span class="sig-prename descclassname"><span class="pre">volume_finder.dihedrals.</span></span><span class="sig-name descname"><span class="pre">get_best_dihedrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_atom_index_to_dihedrals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pearson_to_include</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.dihedrals.get_best_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the dihedral of each residue of interest that correlates most with an observable.</p>
<p>Given a set of dihedrals for each atom of interest and their correlations with an observable,
extract the dihedral of each angle whose correlation (positive or negative) is the strongest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dict_atom_index_to_dihedrals</strong> (<em>dictionary</em>) – Each key is a 0-indexed MDAnalysis atom index.  Each value is the output of
<cite>explain_atom_corr_with_observable</cite>.</p></li>
<li><p><strong>min_pearson_to_include</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum Pearson between the dihedral and observable needed for the angle to be included.
If a residue has no dihedrals whose Pearson exceeds this threshold, then the residue will not
be included in the output.  This function takes the absolute value of Pearsons to consider both
positive and negative correlations as valid; thus <cite>min_pearson_to_include</cite> should be positive.  The default
value is 0, meaning that the best dihedral for a residue will be returned even when that dihedral has
negligible correlation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df_best_angles</strong> – Columns are of the form <cite>index_angle</cite>, e.g. <cite>64_chi1</cite> for the chi1 dihedral of 0-indexed atom 64.
Rows are the dihedral value at each studied time point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-volume_finder.ops_from_volumes">
<span id="volume-finder-ops-from-volumes-module"></span><h2>volume_finder.ops_from_volumes module<a class="headerlink" href="#module-volume_finder.ops_from_volumes" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.ops_from_volumes.compare_frames">
<span class="sig-prename descclassname"><span class="pre">volume_finder.ops_from_volumes.</span></span><span class="sig-name descname"><span class="pre">compare_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj_index_big</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_index_small</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein_surface_big</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein_surface_small</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pocket_big</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pocket_small</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volumes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames_for_volumes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heavy_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.ops_from_volumes.compare_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Get order parameters that quantify the conformational change between two pockets.</p>
<p>Each order parameter is a distance between two atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traj_index_big</strong> (<em>int</em>) – The frame number (0-indexed) of the selected frame where the pocket volume
is bigger.</p></li>
<li><p><strong>traj_index_small</strong> (<em>int</em>) – The frame number (0-indexed) of the selected frame where the pocket volume
is smaller.</p></li>
<li><p><strong>u</strong> (<em>MDAnalysis universe</em>) – The universe object that the data are taken from.</p></li>
<li><p><strong>protein_surface_big</strong> (<em>ProteinSurface object</em>) – A ProteinSurface for the selected frame where the pocket volume
is bigger.</p></li>
<li><p><strong>protein_surface_small</strong> (<em>ProteinSurface object</em>) – A ProteinSurface for the selected frame where the pocket volume
is smaller.</p></li>
<li><p><strong>pocket_big</strong> (<em>trimesh VoxelGrid object</em>) – The pocket interior of the selected frame where the pocket volume
is bigger.  This is found by subtracting the protein surface from the
region of interest</p></li>
<li><p><strong>pocket_small</strong> (<em>trimesh VoxelGrid object</em>) – The pocket interior of the selected frame where the pocket volume
is smaller.</p></li>
<li><p><strong>volumes</strong> (<em>list of floats</em>) – The volume of each frame in frames_for_volumes.</p></li>
<li><p><strong>frames_for_volumes</strong> (<em>slice of MDAnalysis trajectory</em>) – The frames that prots, pockets, and volumes contain.
E.g. u.trajectory[0:50]</p></li>
<li><p><strong>heavy_atoms</strong> (<em>bool</em><em>, </em><em>optional</em>) – When the algorithm checks a hydrogen atoms, and heavy_atoms is True,
the software will switch to the heavy atom that the H is bound to.  The
default value of heavy_atoms is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with information about each order parameter examined by the
software.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas DataFrame</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A DataFrame with information about each order parameter examined by the
software.  There are quite a few columns; the most interesting are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;Atom</span> <span class="pre">1</span> <span class="pre">index&quot;</span></code></dt><dd><p>0-indexed atom index of an atom in the pair.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;Atom</span> <span class="pre">2</span> <span class="pre">index&quot;</span></code></dt><dd><p>0-indexed atom index of the other atom in the pair.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;Pearson</span> <span class="pre">of</span> <span class="pre">dists&quot;</span></code></dt><dd><p>Pearson coefficient between the atom-atom distance and the pocket volume
over all frames in <cite>frames_for_volumes</cite>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;p-value</span> <span class="pre">for</span> <span class="pre">Pearson&quot;</span></code></dt><dd><p>p-value for the Pearson coefficient.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;Rel.</span> <span class="pre">change</span> <span class="pre">in</span> <span class="pre">dist.&quot;</span></code></dt><dd><p>The change in atom-atom distance between the two frames of interest, processed
based on distance magnitude according to <a class="reference external" href="https://en.wikipedia.org/wiki/Relative_change_and_difference">https://en.wikipedia.org/wiki/Relative_change_and_difference</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;Distances&quot;</span></code></dt><dd><p>The atom-atom distance at each studied frame.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.ops_from_volumes.correlate_pockets">
<span class="sig-prename descclassname"><span class="pre">volume_finder.ops_from_volumes.</span></span><span class="sig-name descname"><span class="pre">correlate_pockets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.ops_from_volumes.correlate_pockets" title="Permalink to this definition">¶</a></dt>
<dd><p>Find correlated order parameters between 2 proteins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_1</strong> (<em>Pandas DataFrame</em>) – This should be the output of compare_frames for one of the pockets of interest.</p></li>
<li><p><strong>df_2</strong> (<em>Pandas DataFrame</em>) – This should be the output of compare_frames for the other pocket of interest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame with information about each pair of order parameters examined by the
software.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-volume_finder.volumes">
<span id="volume-finder-volumes-module"></span><h2>volume_finder.volumes module<a class="headerlink" href="#module-volume_finder.volumes" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="volume_finder.volumes.AtomGeo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">AtomGeo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mda_atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_sphere</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.AtomGeo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A surface representation of an atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mda_atom</strong> (<em>MDAnalysis Atom</em>) – The atom of interest.</p></li>
<li><p><strong>voxel_sphere</strong> (<em>trimesh VoxelGrid</em>) – The sphere of volume occupied by the atom.  When constructed as
part of a ProteinSurface, this will have the radius of a solvent
molecule added to it.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="volume_finder.volumes.AtomGeo.mda_atomgroup">
<span class="sig-name descname"><span class="pre">mda_atomgroup</span></span><a class="headerlink" href="#volume_finder.volumes.AtomGeo.mda_atomgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>An AtonGroup containing the atom that was passed during
object construction.  mda_atomgroup[0] accesses the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MDAnalysis AtomGroup containing one atom</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="volume_finder.volumes.AtomGeo.voxel_sphere">
<span class="sig-name descname"><span class="pre">voxel_sphere</span></span><a class="headerlink" href="#volume_finder.volumes.AtomGeo.voxel_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>The sphere that was passed during object construction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="volume_finder.volumes.ProteinSurface">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">ProteinSurface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mda_atomgroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solvent_rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.09</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_geo_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.ProteinSurface" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A surface representation of a protein.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mda_atomgroup</strong> (<em>MDAnalysis Atomgroup</em>) – All the atoms to be included in the surface.</p></li>
<li><p><strong>solvent_rad</strong> (<em>float</em><em>, </em><em>optional</em>) – The protein surface is constructed from the protein atoms’
van der Waals radii plus the radius of a hypothetical solvent molecule.
The default value is 1.09 (the van der Waals radius of hydrogen); this was
chosen because POVME uses this value.</p></li>
<li><p><strong>grid_size</strong> (<em>float</em><em>, </em><em>optional</em>) – The length (in Angstroms) of each side of a voxel.  The default
value is 0.7.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="volume_finder.volumes.ProteinSurface.surf">
<span class="sig-name descname"><span class="pre">surf</span></span><a class="headerlink" href="#volume_finder.volumes.ProteinSurface.surf" title="Permalink to this definition">¶</a></dt>
<dd><p>The surface of the protein.  The interior is filled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="volume_finder.volumes.ProteinSurface.mda_atomgroup">
<span class="sig-name descname"><span class="pre">mda_atomgroup</span></span><a class="headerlink" href="#volume_finder.volumes.ProteinSurface.mda_atomgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>The AtomGroup that was provided during ProteinSurface construction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MDAnalysis Atomgroup</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="volume_finder.volumes.ProteinSurface.atom_geo_list">
<span class="sig-name descname"><span class="pre">atom_geo_list</span></span><a class="headerlink" href="#volume_finder.volumes.ProteinSurface.atom_geo_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains an AtomGeo for each atom in mda_atomgroup.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of AtomGeo objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="volume_finder.volumes.ProteinSurface.solvent_rad">
<span class="sig-name descname"><span class="pre">solvent_rad</span></span><a class="headerlink" href="#volume_finder.volumes.ProteinSurface.solvent_rad" title="Permalink to this definition">¶</a></dt>
<dd><p>The distance that is added to the radius of each atom in the surface.  This is to replicate the
solvent-accessible surface area.  This value should not be changed after object initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.align_to_pocket">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">align_to_pocket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_surf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pocket_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_to_align_to</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.align_to_pocket" title="Permalink to this definition">¶</a></dt>
<dd><p>Align an MD trajectory to the coordinates of a pocket.</p>
<p>Before finding the pocket volume of each frame of the trajectory, it is useful to align the trajectory.
Global alignment can be too imprecise for this; it’s best to align the trajectory to the pocket.  The
trajectory can be aligned to where the pocket is in any frame; the user must choose which frame.  (The
first frame is a logical choice.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_surf</strong> (<em>ProteinSurface object</em>) – The surface at the frame being aligned to.</p></li>
<li><p><strong>pocket_shape</strong> (<em>trimesh VoxelGrod</em>) – The interior of the pocket for the frame being aligned to.  This is found by subtracting
the protein surface from the region of interest using voxel_subtract.</p></li>
<li><p><strong>universe</strong> (<em>MDAnalysis universe</em>) – The universe object that the data are taken from.</p></li>
<li><p><strong>copy_filename</strong> (<em>string</em>) – Because this function returns an MDAnalysis Universe object, it must create a trajectory file
for the Universe to read.  The filename is input here.  This can be either a PDB file or a DCD file.
If it is a DCD, then <cite>psf_loc</cite> must also be given.</p></li>
<li><p><strong>frame_to_align_to</strong> (<em>integer</em>) – The frame of the trajectory that other frames should be aligned to.  protein_surf and pocket_shape should
come from this frame.</p></li>
<li><p><strong>psf_loc</strong> (<em>string</em><em>, </em><em>optional</em>) – If <cite>copy_filename</cite> is a DCD file, then MDAnalysis also needs a PSF file to read the data.  If
<cite>copy_filename</cite> is a PDB file, then <cite>psf_loc</cite> should not be provided.  (The default value is <cite>None</cite>.)</p></li>
<li><p><strong>step</strong> (integer or <cite>None</cite>, optional) – This controls how big of a step to take between frames.  E.g. a value of 1 would lead to
aligning every frame; a value of 2 would lead to aligning every other frame.  (Skipped frames are
not included in the output universe.)  The default value of <cite>None</cite> behaves identically to a value of 1.</p></li>
<li><p><strong>start</strong> (integer or <cite>None</cite>, optional) – This controls which frame to start with.  Frames before <cite>start</cite> are not included in the output universe.
The default value of <cite>None</cite> causes the code to start at the first frame.</p></li>
<li><p><strong>stop</strong> (integer or <cite>None</cite>, optional) – This controls which frame to end with.  Frames at or after <cite>stop</cite> are not included in the output universe.
E.g. if <cite>stop=10</cite> and <cite>start=None</cite>, then the trajectory will include the first 10 frames (indices 0-9).
The default value of <cite>None</cite> causes the code to go until the end of the trajectory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An MDAnalysis universe containing the aligned trajectory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MDAnalysis universe</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.check_equal_pitches">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">check_equal_pitches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_grid_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_grid_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.check_equal_pitches" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that two voxel grids have the same pitch as each other.</p>
<p>Verifies that voxel_grid_1 and voxel_grid_2 have
pitches equal to each other and the same in each
direction.  Raises an error if this is not true.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_grid_1</strong> (<em>trimesh VoxelGrid object</em>) – First shape to compare</p></li>
<li><p><strong>voxel_grid_2</strong> (<em>trimesh VoxelGrid object</em>) – Second shape to compare</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the two shapes have the same pitch as each other and in all directions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.compare_prots">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">compare_prots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_surface_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein_surface_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_regions_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_regions_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.compare_prots" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays two voxelized proteins in a Jupyter notebook.</p>
<p>Uses PyVista to show two proteins.  They are shown together,
and each protein is shown separately.
The protein and pocket are shown as being hollow; i.e. if
users zoom past the surface they’ll see the inside of the shape.
The rest of the software package uses filled shapes, but this
function displays them as hollow to decrease lag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_surface_1</strong> (<em>ProteinSurface object</em>) – One of the proteins to be displayed.</p></li>
<li><p><strong>protein_surface_2</strong> (<em>ProteinSurface object</em>) – The other protein to be displayed.</p></li>
<li><p><strong>color_1</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of the first protein.  The default value is “red”.</p></li>
<li><p><strong>sel_regions_1</strong> (<em>dictionary mapping MDAnalysis AtomGroups to strings</em>) – The colors for selected regions of the first protein.  Large selections slow
the initial rendering.</p></li>
<li><p><strong>color_2</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of the second protein.  The default value is “blue”.</p></li>
<li><p><strong>sel_regions_2</strong> (<em>dictionary mapping MDAnalysis AtomGroups to strings</em>) – The colors for selected regions of the second protein.  Large selections slow
the initial rendering.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.dilate_voxel_grid">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">dilate_voxel_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_grid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.dilate_voxel_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dilated version of the input shape.</p>
<p>The function creates a version of the input shape that has
been expanded by 1 grid position in all dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>voxel_grid</strong> (<em>trimesh VoxelGrid object</em>) – The input shape</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dilated shape</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.generate_voxelized_box">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">generate_voxelized_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.generate_voxelized_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a voxelized box.</p>
<p>The function creates a trimesh VoxelGrid box
based on the input parameters.  The box is filled; i.e.
internal points are occupied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lengths</strong> (<em>list-like object containing three floats</em>) – The box’s side lengths in x, y, z directions</p></li>
<li><p><strong>center</strong> (<em>list-like object containing three floats</em>) – x, y, z coordinates of the sphere’s center.</p></li>
<li><p><strong>grid_size</strong> (<em>float</em>) – Length of a side of the voxel grid.  0.5 is a reasonable
choice.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A VoxelGrid containing the box.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.generate_voxelized_sphere">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">generate_voxelized_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.generate_voxelized_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a voxelized sphere.</p>
<p>The function creates a trimesh VoxelGrid sphere
based on the input parameters.  The sphere is filled;
i.e. internal points are occupied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – Radius of the sphere</p></li>
<li><p><strong>center</strong> (<em>list-like object containing three floats</em>) – x, y, z coordinates of the sphere’s center.</p></li>
<li><p><strong>grid_size</strong> (<em>float</em>) – Length of a side of the voxel grid.  0.5 is a reasonable
choice.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A VoxelGrid containing the sphere.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.get_largest_shape">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">get_largest_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_grid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.get_largest_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the largest shape in a trimesh VoxelGrid.</p>
<p>Voxels kitty-corner from the largest shape are classified as being in a
separate shape; they are discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>voxel_grid</strong> (<em>trimesh VoxelGrid object</em>) – The input VoxelGrid.  This object is not modified by this function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A trimesh VoxelGrid object containing the largest shape in the input
VoxelGrid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.get_pocket_atoms">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">get_pocket_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_surface_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pocket_surf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">universe</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.get_pocket_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all protein atoms that border the pocket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_surface_obj</strong> (<a class="reference internal" href="#volume_finder.volumes.ProteinSurface" title="volume_finder.volumes.ProteinSurface"><em>ProteinSurface</em></a>) – The protein molecule.  The object must be
the ProteinSurface type defined in this software.</p></li>
<li><p><strong>pocket_surf</strong> (<em>trimesh VoxelGrod</em>) – The pocket.</p></li>
<li><p><strong>universe</strong> (<em>MDAnalysis universe</em>) – The universe object that the data are taken from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list of AtomGeo objects</em> – An AtomGeo for each atom bordering the pocket.</p></li>
<li><p><em>ProteinSurface object</em> – A surface containing all atoms bordering the pocket.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.get_prot_pocket">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">get_prot_pocket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_surf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pocket_surf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.get_prot_pocket" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all voxels of the protein that border the pocket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_surf</strong> (<em>trimesh VoxelGrid object</em>) – The protein</p></li>
<li><p><strong>pocket_surf</strong> (<em>trimesh VoxelGrid object</em>) – The pocket</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A VoxelGrid containing voxels in protein_surf that border protein_surf</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.show_one_prot">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">show_one_prot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.show_one_prot" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a voxelized protein in a Jupyter notebook.</p>
<p>Uses PyVista to show a proteins.  It is shown as being hollow; i.e. if
users zoom past the surface they’ll see the inside of the shape.
The rest of the software package uses filled shapes, but this
function displays them as hollow to decrease lag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_surface</strong> (<em>ProteinSurface object</em>) – The protein to be displayed.</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of regions not described by sel_regions.
The default value is “red”.</p></li>
<li><p><strong>sel_regions</strong> (<em>dictionary mapping MDAnalysis AtomGroups to strings</em>) – The colors for selected regions of the protein.  Large selections slow
the initial rendering.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.show_proteinsurf_and_two_voxelgrids">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">show_proteinsurf_and_two_voxelgrids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_grid_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_grid_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_prot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_voxels_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_voxels_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'green'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.show_proteinsurf_and_two_voxelgrids" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a ProteinSurface and two VoxelGrids in a Jupyter notebook.</p>
<p>Uses PyVista to show two objects.  They are shown together,
and each object is shown separately.
The objects are shown as being hollow; i.e. if
users zoom past the surface they’ll see the inside of the shape.
The rest of the software package uses filled shapes, but this
function displays them as hollow to decrease lag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_surface</strong> (<em>ProteinSurface object</em>) – The ProteinSurface to be displayed.</p></li>
<li><p><strong>voxel_grid_1</strong> (<em>trimest VoxelGrid object</em>) – A VoxelGrid to be displayed.</p></li>
<li><p><strong>voxel_grid_2</strong> (<em>trimest VoxelGrid object</em>) – A VoxelGrid to be displayed.</p></li>
<li><p><strong>color_prot</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of the ProteinSurface (except for any regions specified in sel_regions).
The default value is “red”.</p></li>
<li><p><strong>sel_regions</strong> (<em>dictionary mapping MDAnalysis AtomGroups to strings</em>) – The colors for selected regions of the ProteinSurface.  Large selections slow
the initial rendering.</p></li>
<li><p><strong>color_voxels_1</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of the first VoxelGrid.  The default value is “blue”.</p></li>
<li><p><strong>color_voxels_2</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of the second VoxelGrid.  The default value is “green”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.show_proteinsurf_and_voxelgrid">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">show_proteinsurf_and_voxelgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_prot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_voxels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.show_proteinsurf_and_voxelgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a ProteinSurface and a VoxelGrid in a Jupyter notebook.</p>
<p>Uses PyVista to show two objects.  They are shown together,
and each object is shown separately.
The objects are shown as being hollow; i.e. if
users zoom past the surface they’ll see the inside of the shape.
The rest of the software package uses filled shapes, but this
function displays them as hollow to decrease lag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_surface</strong> (<em>ProteinSurface object</em>) – The ProteinSurface to be displayed.</p></li>
<li><p><strong>voxel_grid</strong> (<em>trimest VoxelGrid object</em>) – The VoxelGrid to be displayed.</p></li>
<li><p><strong>color_prot</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of the ProteinSurface (except for any regions specified in sel_regions).
The default value is “red”.</p></li>
<li><p><strong>sel_regions</strong> (<em>dictionary mapping MDAnalysis AtomGroups to strings</em>) – The colors for selected regions of the ProteinSurface.  Large selections slow
the initial rendering.</p></li>
<li><p><strong>color_voxels</strong> (<em>string</em><em>, </em><em>optional</em>) – The color of the VoxelGrid.  The default value is “blue”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.show_two_voxelgrids">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">show_two_voxelgrids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxelgrid_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxelgrid_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.show_two_voxelgrids" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays two trimesh VoxelGrids in a Jupyter notebook.</p>
<p>Uses PyVista to show both the voxelgrids.
The objects are shown as being hollow; i.e. if
users zoom past the surface they’ll see the inside of the shape.
The rest of the software package uses filled shapes, but this
function displays them as hollow to decrease lag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxelgrid_1</strong> (<em>trimesh VoxelGrid object</em>) – The first VoxelGrid</p></li>
<li><p><strong>voxelgrid_2</strong> (<em>trimesh VoxelGrid object</em>) – The second VoxelGrid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.voxel_and">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">voxel_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_grid_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_grid_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.voxel_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all points in both voxel_grid_1 and voxel_grid_2.</p>
<p>Returns a VoxelGrid with all points in both voxel_grid_1
and voxel_grid_2.  Returns None if the two objects have no
points in common.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_grid_1</strong> (<em>trimesh VoxelGrid object</em>) – First shape to be combined.  Must have same pitch in
each dimension.</p></li>
<li><p><strong>voxel_grid_2</strong> (<em>trimesh VoxelGrid object</em>) – Second shape to be combined.  Must have same pitch
in each dimension (and same pitch as voxel_grid_1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A VoxelGrid with all points from both voxel_grid_1 and voxel_grid_2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.voxel_or">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">voxel_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_grid_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_grid_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.voxel_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all points in voxel_grid_1 and/or voxel_grid_2.</p>
<p>Returns a VoxelGrid with all points in at least one of voxel_grid_1 and
voxel_grid_2.  Unlike the trimesh library’s
boolean_sparse function, this function does not require that the
two input grids have the same shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_grid_1</strong> (<em>trimesh VoxelGrid object</em>) – First shape to be combined.  Must have same pitch in
each dimension.</p></li>
<li><p><strong>voxel_grid_2</strong> (<em>trimesh VoxelGrid object</em>) – Second shape to be combined.  Must have same pitch
in each dimension (and same pitch as voxel_grid_1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A VoxelGrid with all points from voxel_grid_1 and/or voxel_grid_2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.voxel_subtract">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">voxel_subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_grid_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_grid_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.voxel_subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>voxel_grid_1 - voxel_grid_2.</p>
<p>Returns a VoxelGrid object containing all points in
voxel_grid_1 that are not in voxel_grid_2.  The
returned VoxelGrid’s pitch is
the same as the input arguments’ pitch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_grid_1</strong> (<em>trimesh VoxelGrid object</em>) – Shape to be subtracted from.  Must have same pitch in
each dimension.</p></li>
<li><p><strong>voxel_grid_2</strong> (<em>trimesh VoxelGrid object</em>) – Shape that is subtracted away.  Must have same pitch
in each dimension (and same pitch as voxel_grid_1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A VoxelGrid with the remaining points from
voxel_grid_1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.voxel_surf_from_numpy">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">voxel_surf_from_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.voxel_surf_from_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a trimesh VoxelGrid from a numpy .npy file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_loc</strong> (<em>string</em>) – The location of a numpy .npy file.  The file should contain points in a voxelized
shape.</p></li>
<li><p><strong>grid_size</strong> (<em>float</em>) – The spacing between grid points</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A trimesh VoxelGrid object containing the points in the data file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trimesh VoxelGrid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="volume_finder.volumes.write_voxels_to_pdb">
<span class="sig-prename descclassname"><span class="pre">volume_finder.volumes.</span></span><span class="sig-name descname"><span class="pre">write_voxels_to_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#volume_finder.volumes.write_voxels_to_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a VoxelGrid object to a PDB file.
Each voxel is written as an atom of name “X”.  The result can
be viewed in PyMOL; users may want to use <cite>set sphere_scale [radius]</cite>
where <cite>radius</cite> is 1/2 the voxel grid size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_grid</strong> (<em>trimesh VoxelGrid object</em>) – The object to be written.</p></li>
<li><p><strong>pdb_filename</strong> (<em>string ending in &quot;.pdb&quot;</em>) – The file to write.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-volume_finder">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-volume_finder" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">volume_finder</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_volumes.html">Calculating Pocket Volumes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Daniel Evans.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/volume_finder.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>